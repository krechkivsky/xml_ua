# DOCX-шаблони (MS Word) і змінні `{{ ... }}`

Плагін `xml_ua` підтримує користувацькі шаблони `.docx` (MS Word) на базі `docxtpl` (Jinja2).
Ви можете створювати власні шаблони і вставляти в них змінні у форматі `{{variable_name}}`.

## Як створити власний шаблон

1. Відкрийте MS Word і створіть новий документ `.docx` (або скопіюйте існуючий шаблон).
2. У потрібних місцях вставте змінні у вигляді **звичайного тексту**, наприклад: `{{ParcelOwner}}`.
3. Збережіть файл у форматі **.docx**.
4. Скопіюйте ваш шаблон у папку плагіна: `templates/`.
5. Перезавантажте плагін (або перезапустіть QGIS).
6. В меню плагіна відкрийте: `Документація → Текстовий документ` і виберіть ваш шаблон.

## Важливо

- Змінні чутливі до написання: `{{ParcelOwner}}` і `{{parcelowner}}` — різні.
- Використовуйте саме подвійні фігурні дужки: `{{ ... }}`.
- Після генерації файл зберігається поруч з вашим `.xml` і відкривається (в MS Word, якщо встановлено).

## Список змінних (доступні в користувацьких шаблонах)

### Завжди доступні (для будь-якого `.docx` у `templates/`)

#### Виконавець робіт

- `{{ExecutorCompanyName}}` - Назва організації виконавця робіт (`CompanyName`)
- `{{ExecutorRegion}}` - Область адреси виконавця
- `{{ExecutorSettlement}}` - Населений пункт адреси виконавця
- `{{ExecutorStreet}}` - Вулиця адреси виконавця
- `{{ExecutorApt}}` - Будинок/будівля адреси виконавця

#### Земельна ділянка

- `{{ParcelOwner}}` - Власники/користувачі ділянки (рядок; якщо декілька — розділені комою та переносом рядка)
- `{{ParcelLocation}}` - Розташування ділянки: `у межах населеного пункту` / `за межами населеного пункту`
- `{{ParcelRegion}}` - Область ділянки
- `{{ParcelDistrict}}` - Район ділянки
- `{{ParcelSettlement}}` - Населений пункт ділянки
- `{{ParcelStreetName}}` - Вулиця (адреса ділянки)
- `{{ParcelBuilding}}` - Номер будинку (адреса ділянки)

#### Довідкові

- `{{CurrentYear}}` - Поточний рік (наприклад, `2026`)
- `{{MSK}}` - Значення МСК (2 перші цифри номера кадастрової зони)

#### Обладнання (з `AdditionalInfoBlock/AdditionalInfo`)

> Ці значення заповнюються, якщо в XML є відповідні рядки `AdditionalInfo`.

- `{{ReceiverModel}}` - Модель GPS-приймача
- `{{ReceiverSN}}` - Серійний номер GPS-приймача
- `{{ReceiverCertNo}}` - № сертифіката калібрування GPS-приймача
- `{{ReceiverCertDate}}` - Дата сертифіката калібрування GPS-приймача
- `{{TotStatModel}}` - Модель тахеометра
- `{{TotStatSN}}` - Серійний номер тахеометра
- `{{TotStatCertNo}}` - № сертифіката калібрування тахеометра
- `{{TotStatCertDate}}` - Дата сертифіката калібрування тахеометра

### Додаткові змінні (для вбудованих шаблонів “Відновлення меж”)

> Ці змінні заповнюються, коли ви запускаєте один із стандартних шаблонів:
> `TD_VM_01_Titul1.docx`, `TD_VM_02_Titul2.docx`, `TD_VM_03_Explanation.docx`.

- `{{QualificationNumber1}}` - № кваліфікаційного сертифіката (виконавець 1)
- `{{QualificationDate1}}` - Дата кваліфікаційного сертифіката (виконавець 1)
- `{{ExecutorName1}}` - ПІБ виконавця 1
- `{{ExecutorPhone}}` - Телефон виконавця 1
- `{{QualificationNumber2}}` - № кваліфікаційного сертифіката (виконавець 2)
- `{{QualificationDate2}}` - Дата кваліфікаційного сертифіката (виконавець 2)
- `{{ExecutorName2}}` - ПІБ виконавця 2

- `{{ReasonInfo}}` - Реквізити договору/підстави виконання робіт (текст)
- `{{Zone}}` - Номер кадастрової зони
- `{{Quarter}}` - Номер кадастрового кварталу
- `{{Parcel}}` - Кадастровий номер/ідентифікатор ділянки
- `{{ExecutorChief}}` - Ініціали та прізвище керівника (виконавець)
- `{{ExecutorExecutor}}` - Ініціали та прізвище виконавця

### Додаткові змінні (для “Пояснюючої записки”, `TD_VM_03_Explanation.docx`)

- `{{ParcelOwnerBorn}}` - ПІБ власника в родовому відмінку (для текстів)
- `{{FormattedParcelAddress}}` - Адреса/опис місця розташування, сформований плагіном

- `{{LandCategoryCode}}` - Код категорії земель
- `{{LandCategoryText}}` - Текст категорії земель
- `{{Area}}` - Площа ділянки (як у XML)

- `{{PurposeCode}}` - Код цільового призначення
- `{{PurposeText}}` - Текст цільового призначення
- `{{LandUseCode}}` - Код використання (як у плагіні)
- `{{LandUseText}}` - Текст використання
- `{{LandPurposeText}}` - Текст призначення для вставки в речення (з малої літери)
- `{{PurposeDoc}}` - Реквізити документа цільового призначення (як у XML)

- `{{RTKContractInfo}}` - Інформація про договір RTK (рядок)
- `{{GPSReceiver}}` - Інформація про GPS-приймач (рядок)
- `{{GPSCert}}` - Інформація про сертифікат GPS (рядок)
- `{{Tachymeter}}` - Інформація про тахеометр (рядок)
- `{{TachymeterCert}}` - Інформація про сертифікат тахеометра (рядок)

- `{{total_land_area}}` - Загальна площа угідь (число як рядок)
- `{{lands}}` - Список угідь (масив об'єктів)
  - `{{land.code}}` - Код угіддя
  - `{{land.name}}` - Назва угіддя
  - `{{land.area}}` - Площа угіддя

- `{{no_restrictions_text}}` - Текст “Обмеження … відсутні” (або порожній)
- `{{restrictions}}` - Список обмежень (масив об'єктів)
  - `{{restriction.code}}` - Код обмеження
  - `{{restriction.name}}` - Назва обмеження
  - `{{restriction.area}}` - Площа обмеження

## Як вставляти списки (угіддя/обмеження)

У `.docx` можна використовувати Jinja2-цикли, наприклад:

```
{% for land in lands %}
{{land.code}} — {{land.name}} — {{land.area}}
{% endfor %}
```
